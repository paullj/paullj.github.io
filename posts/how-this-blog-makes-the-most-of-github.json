{"number":20,"slug":"how-this-blog-makes-the-most-of-github","url":"https://github.com/paullj/paullj.github.io/discussions/20","title":"How This Blog Makes the Most of GitHub","description":"Details on how this website was built, leveraging GitHub Pages, Discussions and Actions.","publishedAt":"2022-02-08T02:26:02Z","lastEditedAt":"2022-06-10T11:02:24Z","createdAt":"2022-02-08T02:26:02Z","author":{"avatarUrl":"https://avatars.githubusercontent.com/u/8403295?s=100&u=1341bb834ef7376719f208388732fcb78aee8899&v=4","login":"paullj","url":"https://github.com/paullj"},"category":"Published Posts","content":"\n<p>This website has been made and remade a few times, each taking a slightly different approach. So far I’ve tried:</p>\n<ul>\n<li><a\n  href=\"https://jekyllrb.com/\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>Jekyll</a></li>\n<li>Local Markdown with <a\n  href=\"https://sapper.svelte.dev/\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>Sapper</a></li>\n<li>Local Markdown with <a\n  href=\"https://kit.svelte.dev/\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>SvelteKit</a></li>\n<li><a\n  href=\"https://sanity.io/\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>Sanity.io</a> with SvelteKit</li>\n</ul>\n<p>But once again, I’ve rewritten this website from scratch…</p>\n<h2 id=\"why-did-this-website-need-a-rewrite\"><a\n  class=\"heading\"\n  href=\"#why-did-this-website-need-a-rewrite\"\n>Why did this website need a rewrite?</a></h2>\n<p>It probably didn’t, but I like the current state its in far better than previous versions (and it was fun to do).</p>\n<p>Although all of the other solutions worked, none of them seemed <em>just right</em>. The previous iteration using Sanity.io as a CMS<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup> was close. However, writing content was cumbersome and the CMS was overkill for writing short blog posts. I found myself not writting anything because it was tedious to do so. </p>\n<h2 id=\"what-makes-a-good-system-for-writing-a-blog\"><a\n  class=\"heading\"\n  href=\"#what-makes-a-good-system-for-writing-a-blog\"\n>What makes a good system for writing a blog?</a></h2>\n<ul>\n<li><strong>Easy to update</strong> - Content should be easy to write</li>\n<li><strong>Draft content</strong> - And preview before publishing</li>\n<li><strong>Feature rich</strong> - Should support: rich text, images, lists, links, etc.</li>\n<li><strong>Fast updates</strong> - Changes should go live as soon as they are made</li>\n<li><strong>Supports comments and reactions</strong> - Not essential, but nice to have</li>\n</ul>\n<h2 id=\"challenges-problems-and-solutions-along-the-way\"><a\n  class=\"heading\"\n  href=\"#challenges-problems-and-solutions-along-the-way\"\n>Challenges, problems and solutions along the way</a></h2>\n<p>Inspired by <a\n  href=\"https://www.swyx.io/github-cms\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>swyx.io’s blog</a> I explored using GitHub as a CMS. Swyx’s blog uses GitHub Issues to write posts leveraging GitHub’s feature-rich markdown. This simple solution is definitely <strong>easy to update</strong> and <strong>feature rich</strong>.</p>\n<p>After first seeing <a\n  href=\"https://utteranc.es/\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>utteranc.es</a><sup\n  id=\"fnref-2\"\n><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup>, I wanted to use it to add comments  through GitHub Issues and this seemed to kill 2 birds with one stone. However, I wasn’t fully onboard with using Issues for posts and comments because it fills a useful issue tracker with dummy issues and feels too much like a workaround. With the relatively new <a\n  href=\"https://github.blog/2020-05-06-new-from-satellite-2020-github-codespaces-github-discussions-securing-code-in-private-repositories-and-more/#discussions\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>addition of GitHub Discussions</a>, it felt better suited for a place to write posts and store comments.</p>\n<blockquote>\n<p>Until now GitHub only offered issues and pull requests as places to have these conversations. But issues and pull requests both have a linear format—well suited for merging code, but not for creating a community knowledge base. Conversations need their own place—that’s what GitHub Discussions is for. … Their threaded format makes it easy to start, respond to, and organize unstructured conversations.</p>\n</blockquote>\n<p>After a quick search I found <a\n  href=\"https://giscus.app/\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>giscus </a>, it is <a\n  href=\"https://laymonage.com/posts/giscus\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>inspired</a> by utteranc.es but uses discussions instead to host conversations. Just like swyx’s issue CMS, discussions have markdown content which can be used in a similar way.</p>\n<p>Conveniently, you can setup <strong>announcement</strong> discussion categories in the <em>discussions</em> tab of a GitHub repository allowing for a place where</p>\n<blockquote>\n<p>maintainers and admins can post new discussions … but anyone can comment and reply. </p>\n</blockquote>\n<p>This sounds like a perfect place to host our blog content. In addition to the other two criteria, we now have a system that also <strong>supports comments and reactions</strong>. The discussion categories also allow for differentiating between <strong>drafts</strong> and <strong>pubished</strong> posts where it is simple to make drafts only visible locally in development.</p>\n<p>I wanted to use GitHub Pages to host this website, so this meant that it had to be fully static. SvelteKit’s static adapter makes this very easy to do, without any configuration<sup\n  id=\"fnref-3\"\n><a href=\"#fn-3\" class=\"footnote-ref\">3</a></sup>!</p>\n<p>To enable <strong>fast updates</strong>, I used GitHub Actions to automatically trigger builds when a discussion is created, edited or when its category is changed. The action only runs if the discussion is in the <strong>published</strong> category as shown in the snippet below.</p>\n<pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> build and push to deploy branch\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">discussion</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>created<span class=\"token punctuation\">,</span> edited<span class=\"token punctuation\">,</span> category_changed<span class=\"token punctuation\">]</span>\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#123;</span>contains(github.event.discussion.category.name<span class=\"token punctuation\">,</span> 'Published')<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">...</span></code></pre>\n<p>To pull content from discussions I wrote a script that parses the markdown and metadata and turns it into content for my blog using the <a\n  href=\"https://docs.github.com/en/graphql/guides/using-the-graphql-api-for-discussions\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>Discussions API</a>. This did come with some challenges. Since it is only available through GitHub’s GraphQL API, it requires authentication for all requests. This is fine in development as I can use a personal access token to authenticate my requests but I thought it might be a problem for deploying. But it didn’t take long to find that GitHub <a\n  href=\"https://docs.github.com/en/actions/security-guides/automatic-token-authentication\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>automatically provides</a> a <code>GITHUB_TOKEN</code> when using Actions. This allows all the requests to be easily authenticated during building and deploying.</p>\n<p>Parsing the discussion body using <a\n  href=\"https://mdsvex.com/\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>mdsvex</a> means I can have very rich content, with code highlighting, frontmatter and other nice formatting out of the box. The frontmatter is especially powerful, allowing for the ability to override metadata and add other whatever other arbitrary information to posts. Additionally with plugins, I added even more ‘nice to have’ features like footnotes, estimated reading time, or oEmbed.  </p>\n<h2 id=\"the-finished-product\"><a class=\"heading\" href=\"#the-finished-product\">The ‘finished’ product</a></h2>\n<p>This website as it is acheives the goals set out at the begining and is a huge improvement on the previous iteration. It really makes use of GitHub’s great features to deliver a minimal but fully featured blog (The best thing is, it is all free!) There are still a few features I would like to add shown below, along with the list of features already implemented. </p>\n<p>You can find <a\n  href=\"https://www.github.com/paullj/paullj.github.io\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>all the code on GitHub</a>, feel free to poke around or use anything that might be useful for you.</p>\n<p>Leave your thoughts and reactions (or just try giscus) below!</p>\n<h3 id=\"features-and-to-do\"><a class=\"heading\" href=\"#features-and-to-do\">Features and To Do</a></h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> Fully static, hostable on Github Pages</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> Responsive design with <a\n  href=\"https://github.com/antfu/unocss\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>UnoCSS</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <a\n  href=\"https://github.com/paullj/paullj.github.io/discussions/20\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>GitHub Discusions as a CMS</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <a\n  href=\"https://github.com/paullj/paullj.github.io/discussions/20#discussioncomment-2132732\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>Comments</a> and reactions on each post</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> Automatic deployment with GitHub Actions</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> Works without Javascript</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> Performant</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> Basic SEO</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> <a\n  href=\"https://github.com/paullj/paullj.github.io/blob/main/src/lib/components/ToggleDarkMode.svelte\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>Automatic dark mode</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> Privacy focused <a\n  href=\"https://www.goatcounter.com/\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>analytics</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> RSS feed</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Better error page, with suggestions</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Post search</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Post pagination</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" checked disabled> View counter</li>\n</ul>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">A <strong>content management system</strong>, where you can author content and upload media<a\n  href=\"#fnref-1\"\n  class=\"footnote-backref\"\n>↩</a></li>\n<li id=\"fn-2\">A clever comments systems built with GitHub Issues<a\n  href=\"#fnref-2\"\n  class=\"footnote-backref\"\n>↩</a></li>\n<li id=\"fn-3\">A bit of <a\n  href=\"https://github.com/sveltejs/kit/tree/master/packages/adapter-static#github-pages\"\n  rel=\"nofollow noopener noreferrer\"\n  target=\"_blank\"\n>configuration necessary</a> if you are hosting at <code>user.github.io/repo</code> instead of <code>user.github.io</code><a href=\"#fnref-3\" class=\"footnote-backref\">↩</a></li>\n</ol>\n</div>\n","reactions":2,"comments":1,"readingTime":5,"viewCount":280}